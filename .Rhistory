proj.name     = "forecast",
models.chosen = "all"
)
clim_sub      <- cgc_sub[[supfam]][[bn]]
clim_proj_sub <- subset(climosaic_ssp126, names(clim_sub))
# Projection dans un scénario ----
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
mod_ensemble@models.out@link <- mod_ensemble@models.out@link %>%
pathClusterBiomod()
pathClusterBiomod <- function(x) {
gsub(
"/scratchbeta/manielg",
"/home/borea/Documents/mosceco/r_projects",
x
)
}
mod_ensemble@models.out@link <- mod_ensemble@models.out@link %>%
pathClusterBiomod()
mod_ensemble@models.evaluation@link <- mod_ensemble@models.evaluation@link %>%
pathClusterBiomod()
mod_ensemble@variables.importance@link <- mod_ensemble@variables.importance@link %>%
pathClusterBiomod()
mod_ensemble@models.prediction@link <- mod_ensemble@models.prediction@link %>%
pathClusterBiomod()
mod_ensemble@models.prediction.eval@link <- mod_ensemble@models.prediction.eval@link %>%
pathClusterBiomod()
mod_ensemble@link <- mod_ensemble@link %>% pathClusterBiomod()
mod_ensemble@models.prediction@link
mod_ensemble@models.prediction.eval@link
mod_ensemble@link
mod_ensemble@models.evaluation@link
mod_ensemble@variables.importance@link
mod_ensemble@models.prediction@link
mod_ensemble@models.prediction@link %>% file.exists()
load(mod_ensemble@models.prediction@link)
o <- get(models.prediciton)
o <- get(models.prediction)
o <- get(models.prediction)
e <- load(mod_ensemble@models.prediction@link)
e
get(objValue)
source(here::here("scripts", "boot.R"))
# Projection futures : scénarios du GIEC ----
source(here("scripts", "giec_sst_slr.R"))
source(here("scripts", "data_environment_ipcc.R"))
# Projection avec valeurs de l'IPCC ----
climosaic_ssp126
climosaic_ssp585
supfam <- "Majoidea"
clim_sub      <- cgc_sub[[supfam]][[bn]]
bn     <- "Stenorhynchus seticornis"
clim_sub      <- cgc_sub[[supfam]][[bn]]
clim_proj_sub <- subset(climosaic_ssp126, names(clim_sub))
# supfam <- "Majoidea"
# bn     <- "Stenorhynchus seticornis"
path_models_out <- here("data", "analysis", "models", supfam, bn)
path_models_out
pth <- list.files(path_models_out, full.names = T)[[1]]
list.files(
pth, pattern = "ensemble.models.out", full.names = T
)
pth
setwd(pth)
list.files()
pth_out
# pth <- list.files(path_models_out, full.names = T)[[1]]
pth_out <- list.files(
pth, pattern = "ensemble.models.out", full.names = T
)
pth_out
setwd(pth)
list.files(pattern = "ensemble.models.out")
load(list.files(pattern = "ensemble.models.out"))
nam_out <- list.files(pth, pattern = "ensemble.models.out")
nam_out
mod_ensemble <- get(nam_out)
# Projection dans un scénario ----
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
clim_sub
clim_proj_sub
pth_out <- list.files(
pth, pattern = "ensemble.models.out", full.names = T
)
nam_out <- list.files(pth, pattern = "ensemble.models.out")
pth_out
nam_out
load(pth_out)
mod_ensemble <- get(nam_out)
mod_ensemble
class(mod_ensemble)
mod_ensemble
# Projection dans un scénario ----
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
pth_out
pth
# Projection dans un scénario ----
setwd(pth)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
pth
# Projection dans un scénario ----
setwd(pth_out)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
pth_out
pth
# Projection dans un scénario ----
setwd(pth)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
mod_ensemble
# Projection dans un scénario ----
setwd(pth)
pth
mod_ensemble@models.out@link
pth, "models")
pth
here(pth, "models")
# Projection dans un scénario ----
setwd(here(pth, "models"))
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
# Projection dans un scénario ----
setwd(here(pth, "models", "Ste.set.ens5.01.global.cpc"))
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
# pth <- list.files(path_models_out, full.names = T)[[1]]
pth_out <- list.files(
pth, pattern = "ensemble.models.out", full.names = T
)
list.files(
pth,)
cpc_out <- list.files(
pth, pattern = "cpc.models.out", full.names = T
)
cpc_out <- list.files(pth, pattern = "cpc.models.out")
cpc_out
load(cpc_out)
mod_ensemble <- get(cpc_out)
cpc_out
cpc_out <- list.files(
pth, pattern = "cpc.models.out", full.names = T
)
nac_out <- list.files(pth, pattern = "cpc.models.out")
cpc_out <- list.files(
pth, pattern = "cpc.models.out", full.names = T
)
nac_out <- list.files(pth, pattern = "cpc.models.out")
load(cpc_out)
mod_ensemble <- get(nac_out)
mod_ensemble %>% class()
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
load(cpc_out)
mod_cpc <- get(nac_out)
load(pth_out)
mod_ensemble <- get(nam_out)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
?BIOMOD_EnsembleForecasting
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all",
metric.binary = 'all',
metric.filter = 'all'
)
mod_ensemble
pth
list.files(pth)
# Projection dans un scénario ----
setwd(pth)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
path_models_out
# Projection dans un scénario ----
setwd(path_models_out)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
list.files(path_models_out)
here(path_models_out, "Ste.set.ens5.01.global.cpc" )
# Projection dans un scénario ----
setwd(here(path_models_out, "Ste.set.ens5.01.global.cpc" ))
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
load(pth_out)
mod_ensemble <- get(nam_out)
pathClusterBiomod <- function(x) {
gsub(
"/scratchbeta/manielg",
"/home/borea/Documents/mosceco/r_projects",
x
)
}
mod_ensemble@models.out@link <- mod_ensemble@models.out@link %>%
pathClusterBiomod()
mod_ensemble@models.evaluation@link <- mod_ensemble@models.evaluation@link %>%
pathClusterBiomod()
mod_ensemble@variables.importance@link <- mod_ensemble@variables.importance@link %>%
pathClusterBiomod()
mod_ensemble@models.prediction@link <- mod_ensemble@models.prediction@link %>%
pathClusterBiomod()
mod_ensemble@models.prediction.eval@link <- mod_ensemble@models.prediction.eval@link %>%
pathClusterBiomod()
mod_ensemble@link <- mod_ensemble@link %>% pathClusterBiomod()
mod_ensemble@models.out@link
load(pth_out)
mod_ensemble <- get(nam_out)
mod_ensemble@models.out@link
# mod_ensemble@dir.name        <- path_models_out
# mod_ensemble@link            <- pth_out
mod_ensemble@models.out@link <- pth_out
mod_ensemble@models.out@link
# Projection dans un scénario ----
setwd(here(path_models_out, "Ste.set.ens5.01.global.cpc" ))
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
mod_ensemble@models.out
load(mod_ensemble@models.out)
load(mod_ensemble@models.out@link)
a <- get(load(mod_ensemble@models.out@link))
class(a)
load_stored_object(mod_ensemble)
load_stored_object(mod_ensemble@models.out)
mod_ensemble@models.out
pth_out
list.files(pth, pattern = "cpc.models.out")
# mod_ensemble@dir.name        <- path_models_out
# mod_ensemble@link            <- pth_out
mod_ensemble@models.out@link <- list.files(pth, pattern = "cpc.models.out", full.names = T)
mod_ensemble@models.out@link
a <- get(load_stored_object(mod_ensemble@models.out))
mod_ensemble@models.out
a <- get(load_stored_object(mod_ensemble@models.out))
load_stored_object(mod_ensemble@models.out)
load_stored_object(mod_ensemble@models.out)
mod_ensemble@models.out@link
mod_ensemble@models.out
load_stored_object(mod_ensemble@models.out)
a <- load_stored_object(mod_ensemble@models.out)
class(a)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
# Projection dans un scénario ----
setwd(here(path_models_out, "Ste.set.ens5.01.global.cpc" ))
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
getwd()
path_models_out
# Projection dans un scénario ----
setwd(path_models_out)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
load(pth_out)
mod_ensemble <- get(nam_out)
source("~/Documents/mosceco/r_projects/MOSCECO_L2/habitat_suitability/scripts/biomod_model_link.R", echo=TRUE)
pathClusterBiomod <- function(x) {
gsub(
"/scratchbeta/manielg",
"/home/borea/Documents/mosceco/r_projects",
x
)
}
mod_ensemble@models.out@link <- mod_ensemble@models.out@link %>%
pathClusterBiomod()
mod_ensemble@models.evaluation@link <- mod_ensemble@models.evaluation@link %>%
pathClusterBiomod()
mod_ensemble@variables.importance@link <- mod_ensemble@variables.importance@link %>%
pathClusterBiomod()
mod_ensemble@models.prediction@link <- mod_ensemble@models.prediction@link %>%
pathClusterBiomod()
mod_ensemble@models.prediction.eval@link <- mod_ensemble@models.prediction.eval@link %>%
pathClusterBiomod()
mod_ensemble@link <- mod_ensemble@link %>% pathClusterBiomod()
# mod_ensemble@dir.name        <- path_models_out
# mod_ensemble@link            <- pth_out
mod_ensemble@models.out@link <- list.files(pth, pattern = "cpc.models.out", full.names = T)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
# Projection dans un scénario ----
setwd(path_models_out)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
mod_ensemble
mod_ensemble@link
mod_ensemble@models.prediction.eval@link
mod_ensemble@models.prediction@link
mod_ensemble@variables.importance@link
mod_ensemble@models.evaluation@link
mod_ensemble@models.out@link
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
list.files(here(pth))
list.files(here(pth, "models"))
list.files(here(pth, "models", "Ste.set.ens5.01.global.cpc"))
a <- get(load(list.files(here(pth, "models", "Ste.set.ens5.01.global.cpc"))[[1]]))
a <- get(load(list.files(here(pth, "models", "Ste.set.ens5.01.global.cpc"), full.names = T)[[1]]))
class(a)
a@dir_name
a@model_options
a@model
a@scaling_model
a@resp_name
a@expl_var_range
a <- get(load(list.files(here(pth, "models", "Ste.set.ens5.01.global.cpc"), full.names = T)[[1]]))
list.files(here(pth, "models", "Ste.set.ens5.01.global.cpc"), full.names = T)
a@dir_name
lapply(
list.files(here(pth, "models", "Ste.set.ens5.01.global.cpc"), full.names = T),
\(x) {
m <- get(load(x))
m@dir.name <- pathClusterBiomod(m@dir.name)
}
)
x <- list.files(here(pth, "models", "Ste.set.ens5.01.global.cpc"), full.names = T)[[1]]
x
# x <- list.files(here(pth, "models", "Ste.set.ens5.01.global.cpc"), full.names = T)[[1]]
m <- get(load(x))
m
class(m)
m@dir_name
m@dir.name <- pathClusterBiomod(m@dir.name)
m@dir_name <- pathClusterBiomod(m@dir_name)
class(m)
View(m)
View(cpc_out)
View(mod_cpc)
load(pth_out)
mod_ensemble <- get(nam_out)
mod_ensemble
View(mod_ensemble)
mod_ensemble@dir.name
mod_ensemble@dir.name <- ""
mod_ensemble@dir.name
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
mod_ensemble@models.out@link <- ""
mod_ensemble@models.evaluation@link <- ""
mod_ensemble@variables.importance@link <- ""
mod_ensemble@models.prediction@link <- ""
mod_ensemble@models.prediction.eval@link <- ""
mod_ensemble@link <- ""
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
load(pth_out)
mod_ensemble <- get(nam_out)
proj_ipcc <- BIOMOD_EnsembleForecasting(
bm.em         = mod_ensemble,
new.env       = clim_proj_sub,
proj.name     = "forecast",
models.chosen = "all"
)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document")
pth_out
pth
clim_sub      <- cgc_sub[[supfam]][[bn]]
here("data", "tidy") %>% list.files()
path_ipcc <- here("data", "tidy", "climatologies_ipcc")
makeMyDir(path_ipcc)
source(here("scripts", "giec_sst_slr.R"))
source(here("scripts", "data_environment_ipcc.R"))
# Chargement rasters scénarios
climosaic_ssp126 <- here("data", "tidy", "climatologies_ipcc", "ssp126.rds") %>%
readRDS()
pth_out
pth
here(pth, "proj_current") %>% list.files(pattern = "tif")
cur <- here(pth, "proj_current") %>%
list.files(pattern = "tif", full.names = T) %>%
rast()
fut <- here(pth, "proj_forecast") %>%
list.files(pattern = "tif", full.names = T) %>%
rast()
cur
fut
plot(fut)
x11(); plot(cur)
x11(); plot(fut)
as.formula(climosaic_ssp126)
here("data", "tidy", "climatologies_ipcc") %>%
list.files(pattern = "rds")
ssp <- "ssp126"
ssp
paste("forecast", ssp, sep = "/")
?BIOMOD_EnsembleForecasting
paste("proj", paste("forecast", ssp, sep = "/"), sep = "_")
paste("proj", paste("forecast", ssp, sep = "/"), sep = "_")
here(
pth,
paste("proj", paste("forecast", ssp, sep = "/"), sep = "_"),
"proj_ipcc.rds"
)
paste("forecast", ssp, sep = "/")
paste0("forecast", ssp)
paste("forecast", ssp, sep = "_")
paste("proj", paste("forecast", ssp, sep = "_"), sep = "_")
here(
pth,
paste("proj", paste("forecast", ssp, sep = "_"), sep = "_"),
"proj_ipcc_df.rds"
)
here(
pth,
paste("proj", paste("forecast", ssp, sep = "_"), sep = "_"),
"proj_ipcc.rds"
)
paste("forecast", ssp, sep = "_")
