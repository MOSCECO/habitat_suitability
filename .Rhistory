ggplot(
tb3,
aes(x = name, y = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
vjust = -0.7
) +
scale_fill_manual(values = c("white", "green")) +
guides(
fill = guide_legend(title = NULL),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
labs(
title = paste0(binomial_name, " (", isl_lab, ")"),
subtitle = paste("Algorithme de compilation :", alg_lab)
) +
xlab("Algorithme de modélisation") +
ylab("Nombre d'absences correctement prédites")
},
c("ensemble", "maxent", "rf"),
SIMPLIFY = F,
USE.NAMES = T
)
},
simplify = F,
USE.NAMES = T
)
},
simplify = F,
USE.NAMES = T
)
proportions_pa
# présences/absences à l'habitat
proportions_pa <- sapply(
names(pa),
\(alg) {
# alg <- names(pa)[[1]]
alg_lab <- switch(
alg, wmean = "Moyenne pondérée", ca = "Moyenne d'ensemble"
)
sapply(
names(pa[[alg]]),
\(nisl) {
# nisl <- names(pa[[alg]])[[1]]
isl_lab <- switch(
nisl,
ANT = "Guadeloupe et Martinique",
GLP = "Guadeloupe",
MTQ = "Martinique"
)
tb <- pa[[alg]][[nisl]]
mapply(
\(alg_mod) {
# alg_mod <- "ensemble"
tb0 <- tb %>%
pivot_longer(cols = c("ensemble", "maxent", "rf")) %>%
st_drop_geometry(.) %>%
filter(value == 0) %>%
group_by(., name) %>%
summarise(., count = n()) %>%
cbind(model_val = "absence")
tb1 <- tb %>%
pivot_longer(cols = c("ensemble", "maxent", "rf")) %>%
st_drop_geometry(.) %>%
filter(value == 1) %>%
group_by(., name) %>%
summarise(., count = n()) %>%
cbind(model_val = "presence")
tb2 <- tb1 %>% rbind(tb0)
tb2$model_val <- factor(tb2$model_val, ordered = T)
tb3 <- tb2 %>% filter(name == alg_mod)
ggplot(
tb3,
aes(x = name, y = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
vjust = -0.7
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Adéquat", "Non-adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
labs(
title = paste0(binomial_name, " (", isl_lab, ")"),
subtitle = paste("Algorithme de compilation :", alg_lab)
) +
xlab("Algorithme de modélisation") +
ylab("Nombre d'absences correctement prédites")
},
c("ensemble", "maxent", "rf"),
SIMPLIFY = F,
USE.NAMES = T
)
},
simplify = F,
USE.NAMES = T
)
},
simplify = F,
USE.NAMES = T
)
proportions_pa
source("~/Documents/mosceco/r_projects/MOSCECO_L2/habitat_suitability/scripts/sdm_1algo_Claremontiella_nodulosa_4A_05_verification_pa.R", echo=TRUE)
# préparation des cartes ----
# pour chaque combinaison algorithme compilation / île
p_alg_pa <- sapply(
names(mods),
\(alg_compilation) {
alg_comp <- switch(
alg_compilation, wmean = "Moyenne pondérée", ca = "Moyenne d'ensemble"
)
sapply(
names(mods[[alg_compilation]]),
\(alg_modelisation) {
alg_modl <- switch(
alg_modelisation,
ensemble = "Ensemble",
maxent   = "Maximum d'entropie (MAXENT)",
rf       = "Forêt aléatoire (Random Forest)"
)
sr <- mods[[alg_compilation]][[alg_modelisation]]
p_pa <- plotComparaisonOccurrences_pa(sr, alg_comp, alg_modl)
},
simplify = F,
USE.NAMES = T
)
},
simplify = F,
USE.NAMES = T
)
source("~/Documents/mosceco/r_projects/MOSCECO_L2/habitat_suitability/scripts/FUN/FUN_plotComparaisonOccurrences_pa.R", echo=TRUE)
source("~/Documents/mosceco/r_projects/MOSCECO_L2/habitat_suitability/scripts/sdm_1algo_Claremontiella_nodulosa_4A_05_verification_pa.R", echo=TRUE)
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
vjust = -0.7
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
labs(
title = paste0(binomial_name, " (", isl_lab, ")"),
subtitle = paste("Algorithme de compilation :", alg_lab)
) +
xlab("Algorithme de modélisation") +
ylab("Nombre d'absences correctement prédites")
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
vjust = -0.7
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
labs(
title = paste0(binomial_name, " (", isl_lab, ")"),
subtitle = paste("Algorithme de compilation :", alg_lab)
) +
xlab("Algorithme de modélisation") +
ylab("Nombre d'absences correctement prédites")
dev.off()
dev.off()
dev.off()
dev.off()
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
vjust = -0.7
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
labs(
title = paste0(binomial_name, " (", isl_lab, ")"),
subtitle = paste("Algorithme de compilation :", alg_lab)
) +
xlab("Algorithme de modélisation") +
ylab("Nombre d'absences correctement prédites")
source("~/Documents/mosceco/r_projects/MOSCECO_L2/habitat_suitability/scripts/boot.R", echo=TRUE)
for (i in 1:10) { dev.off() }
source("~/Documents/mosceco/r_projects/MOSCECO_L2/habitat_suitability/scripts/sdm_1algo_Claremontiella_nodulosa_4A_05_verification_pa.R", echo=TRUE)
nisl <- names(pa[[alg]])[[1]]
alg <- names(pa)[[1]]
alg_lab <- switch(
alg, wmean = "Moyenne pondérée", ca = "Moyenne d'ensemble"
)
isl_lab <- switch(
nisl,
ANT = "Guadeloupe et Martinique",
GLP = "Guadeloupe",
MTQ = "Martinique"
)
tb <- pa[[alg]][[nisl]]
nisl <- names(pa[[alg]])[[1]]
isl_lab <- switch(
nisl,
ANT = "Guadeloupe et Martinique",
GLP = "Guadeloupe",
MTQ = "Martinique"
)
tb <- pa[[alg]][[nisl]]
alg_mod <- "ensemble"
tb0 <- tb %>%
pivot_longer(cols = c("ensemble", "maxent", "rf")) %>%
st_drop_geometry(.) %>%
filter(value == 0) %>%
group_by(., name) %>%
summarise(., count = n()) %>%
cbind(model_val = "absence")
tb1 <- tb %>%
pivot_longer(cols = c("ensemble", "maxent", "rf")) %>%
st_drop_geometry(.) %>%
filter(value == 1) %>%
group_by(., name) %>%
summarise(., count = n()) %>%
cbind(model_val = "presence")
tb2 <- tb1 %>% rbind(tb0)
tb2$model_val <- factor(tb2$model_val, ordered = T)
tb3 <- tb2 %>% filter(name == alg_mod)
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8)
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
xlab("Algorithme de modélisation") +
ylab("Présences correctement prédites")
tb3
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8)
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
xlab("Algorithme de modélisation") +
ylab("Présences correctement prédites")
dev.off()
x11()
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8)
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
xlab("Algorithme de modélisation") +
ylab("Présences correctement prédites")
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
hjust = -0.7
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
xlab("Algorithme de modélisation") +
ylab("Présences correctement prédites")
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
hjust = -0.7
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
ylab("Présences correctement prédites") +
theme(
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
hjust = -0.7
) +
scale_fill_manual(
values = c("white", "green"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
ylab("Présences correctement prédites") +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(col = "black", width = 0.8, position = "dodge2") +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
hjust = -0.7
) +
scale_fill_manual(
values = c("white", "#03a700"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
ylab("Présences correctement prédites") +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(
col = "black", width = 0.8, position = "dodge2", alpha = 0.8
) +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
hjust = -0.7
) +
scale_fill_manual(
values = c("white", "#03a700"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
ylab("Présences correctement prédites") +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(
col = "black", width = 0.8, position = "dodge2", alpha = 0.8
) +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
hjust = -0.7
) +
scale_fill_manual(
values = c("white", "#03a700"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
xlab("Présences correctement prédites") +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(
col = "black", width = 0.8, position = "dodge2", alpha = 0.8
) +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
hjust = -0.7
) +
scale_fill_manual(
values = c("white", "#03a700"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
xlab("Présences correctement prédites") +
xlab(NA) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
ggplot(
tb3,
aes(y = name, x = count, group = name, fill = model_val)
) +
geom_col(
col = "black", width = 0.8, position = "dodge2", alpha = 0.8
) +
geom_text(
aes(label = count),
position = position_dodge2(width = 0.8),
hjust = -0.7
) +
scale_fill_manual(
values = c("white", "#03a700"),
labels = c("Non-adéquat", "Adéquat")
) +
guides(
fill = guide_legend(title = "Environnement"),
col = guide_legend(title = "Algorithme\nde modélisation")
) +
xlab("Présences correctement prédites") +
ylab(NULL) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
source("~/Documents/mosceco/r_projects/MOSCECO_L2/habitat_suitability/scripts/sdm_1algo_Claremontiella_nodulosa_4A_05_verification_pa.R", echo=TRUE)
source("~/Documents/mosceco/r_projects/MOSCECO_L2/habitat_suitability/scripts/sdm_1algo_Claremontiella_nodulosa_4A_05_verification_pa.R", echo=TRUE)
